<?php

/*
 * This is a list of stings and patterns that indicate 
 * a potential malware infection
 * 
 */

    $jamssStrings = 'r0nin|m0rtix|upl0ad|r57shell|c99shell|shellbot|phpshell|void\.ru|phpremoteview|directmail|bash_history|brute *force|multiviews|cwings|vandal|bitchx|eggdrop|guardservices|psybnc|dalnet|undernet|vulnscan|spymeta|raslan58|Webshell';

    // the patterns to search for
    $jamssPatterns = array(
        array( 'preg_replace\s*\(\s*[\"\'\”]\s*\/\s*\.\s*\*\s*\/\s*e\s*[\"\'\”]',
                'Backdoor: PHP:PREG_REPLACE:EVAL',
                '1',
                'Detected a malicious code hidden under a preg_replace with the "e" switch that acts as an eval call (code execution). It is often used to bypass simple detection methods that only look for "eval(" call itself.',
                'http://sucuri.net/malware/backdoor-phppreg_replaceeval'),
        array( 'c999sh_surl',
                'Backdoor: PHP:C99:045',
                '2',
                'Detected the "C99? backdoor that allows attackers to manage (and reinfect) your site remotely. It is often used as part of a compromise to maintain access to the hacked sites.',
                'http://sucuri.net/malware/backdoor-phpc99045'),
        array( 'preg_match\s*\(\s*\"\s*\/\s*bot\s*\/\s*\"',
                'Backdoor: PHP:R57:01',
                '3',
                'Detected the "R57? backdoor that allows attackers to access, modify and reinfect your site. It is often hidden in the filesystem and hard to find without access to the server or logs.',
                'http://sucuri.net/malware/backdoor-phpr5701'),
        array( 'eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(',
                'Backdoor: PHP:EVAL:GZINFLATE:B64',
                '4',
                'Detected a highly encoded (and malicious) code hidden under a loop of gzinflate/gzuncompress/base64_decode calls. After decoded, it goes through an eval call to execute the code.',
                'http://sucuri.net/malware/backdoor-phpevalgzinflateb64'),
        array( 'eval\s*\(stripslashes\s*\(\s*\$_REQUEST\s*\[\s*\\\s*[\'\"]\s*asc\s*\\\s*[\'\"]',
                'Backdoor: PHP:GENERIC:07',
                '5',
                'Detected a generic backdoor that allows attackers to upload files, delete files, access, modify and/or reinfect your site. It is often hidden in the filesystem and hard to find without access to the server or logs. It also includes uploadify scripts and similars that offer upload options without security. ',
                'http://sucuri.net/malware/backdoor-phpgeneric07'),
        array( 'https?\S{1,63}\.ru',
                'russian URL',
                '6',
                'Detected a .RU domain link, as there are many attacks leading the innocent visitors to .RU pages. Maybe i\'s valid link, but we leave it to you to check this out.',
            ),
        array( 'preg_replace\s*\(\s*[\"\'\”]\s*\/\s*\.\s*\*\s*\/\s*e\s*[\"\'\”]\s*,\s*[\"\'\”]\s*\\x65\\x76\\x61\\x6c',
                'Backdoor: PHP:Filesman:02',
                '7',
                'We detected the “Filesman” backdoor that allows attackers to access, modify and reinfect your site. It is often hidden in the filesystem and hard to find without access to the server or logs.',
                'http://sucuri.net/malware/backdoor-phpfilesman02'),
    );

?>
