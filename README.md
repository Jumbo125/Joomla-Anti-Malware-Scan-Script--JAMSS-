# JAMSS - Anti-Malware Scan Script for Joomla!
***
The JAMSS stands for **_Joomla! Anti-Malware Scan Script_**, a self-service script that will be continually programmed to assist all Joomla! owners to check their Joomla! installation for various website-malware. The script currently uses RegEx fingerprint patterns to identify the most common fingerprints, traces and indices that some files have/could've be compromised.

JAMSS should be used for assistance in locating possibly infected or added malware/backdoor files in Joomla! installations.

JAMSS still **doesn't do any cleanup on its own**, it's only informative about some suspicious code in your Joomla! installation.

JAMSS is _far from being 100% accurate_. It has just a few patterns at this moment, and the false-positives are very well to be expected. So you may only use it wisely and with caution. I do not take any resposibility for any damages you might suffer by following some advices or results of JAMSS.

***

!!! DISCLAIMER !!!
------------------
* JAMSS IS NOT A "ONE-CLICK" CURE, IT'S ONLY A TOOL TO AID IDENTIFICATION OF (POSSIBLY) MALICIOUS FILES !

* JAMSS WILL PRODUCE FALSE POSITIVES!

* Patterns that are often used in highly encoded, malicious code are also used for legitimate purposes in both the Joomla core and within 3rd party extensions, e.g. storing configuration information or serialized object data.

* Please inspect the reported file(s) manually and compare it/them with the one(s) in a freshly downloaded extension or freshly downloaded full Joomla package to verify that the result displayed is not a false positive.


## General Notes (read it carefully!)
* the script is NOT approved, tested or verified by Joomla team, forum team, security team or anyone else - it is an assistant tool to use in addition to the use of other tools and recommendations found on the Joomla security forums.
* JAMSS is tool intended just as a quick help in fast search and identification of POSSIBLY corrupted files in you web directory.
* JAMSS doesn't change anything on your site, and doesn't remove vulnerabilities you might have - sorry, you still have to do all the handwork by yourself
* false positives are very likely due to the fact that many valid scripts make use of the same logic/technologies as the hacker scripts do to achieve their required activities. Interpretation must be applied to the results as it is better to have a false positive than just one false negative. The code is still "work in progress", so be cautious!
* JAMSS is intended for people with some degree of understanding of PHP code.
* don't simply go and delete all files it identifies, you will break your Joomla installation!!! (you have been warned... read on)
* don't simply go and notify an extension developer of files in their extension the JAMSS identifies unless you are 100% positive the identified code that is not legitimate to the extension.
* also, JAMSS surely can't identify each and every possible malware, as it is with all other sorts AntiVirus/AntiMalware applications. Nothing's perfect, neither is the JAMSS. Don't rely 100% on it!
* by downloading and using JAMSS you confirm that you have read, do fully understand, accept and agree to all terms and conditions written here or in any other file belonging to JAMSS package.
* I DON'T ISSUE ANY WARRANTY for the script, it is given "as is" and you have to use it at your own risk alone


### Discussion for JAMSS is located here:
http://forum.joomla.org/viewtopic.php?f=621&t=777960


### Feedback & Bugs should be reported here
https://github.com/btoplak/Joomla-Anti-Malware-Scan-Script/issues

##### ALL COMMENTS AND SUGGESTIONS ON CODE, BEHAVIOR, FINGERPRINTS ETC. ARE ALWAYS WELCOME!

***

### Usage instructions
The usage is pretty simple and straightforward:

* upload jamss.php to the webroot of your hosting account
* open the scanner file in your browser using URL like this http://www.your-joomla-site.com/jamss.php
* the script will run for several seconds, maybe even minutes, depending on number of your files and load on your webserver


#### DeepScan (ONLY FOR VERY ADVANCED USERS - PHP KNOWLEDGE IS ESSENTIAL!!)

If you want to perform a "deep scan", you can pass the "deepscan=1" parameter to the script via the url.
Eg. http://yoursite.com/jamss.php?deepscan=1

The _deepscan_ method will search files for many PHP functions known to be used for malicious scripts, which may detect more recent/unknown versions of PHP malware, and this DEFINTELY WILL give many false positives. You have to be a experienced PHP programmer to interpret the results properly.


### Interpreting the results:
0. The script might take up to minute or two to scan and finish if your server is under heavy load, or you have many files, so lean back and wait a moment.
0. The script inspects code contained within files and tries to identify possible malicious code in it using many fingerprints of known malware.
1. Once the script has finished running it will produce and display a report for review, and (as warned before) will likely produce also "false positives" that must be interpreted in order to determine if any particular result is a possible hijacked file.
2. For each potential issue, the report will list the path to the file in question, the pattern (and pattern internal number) that the file matched to, short description what this code could be doing, and the general area within the file that matched the pattern.
If there is any question about a file(s) identified as possibly having an issue, the file(s) should be downloaded and inspected to determine if there is an issue with the file:
- if suspected file exists in original Joomla or used extensions files (download all ZIP/TAR.XX packages and check it), then replace the file with the file of corresponding Joomla! version (the same you have running)
- even better - Properly clean your complete Joomla webdir with fresh Joomla files following the information and recommendations in the security forums http://forum.joomla.org/viewtopic.php?f=621&t=582854
- if the suspected file(s) does/do not exist in original Joomla full installation files or the installed extensions files, then move the file(s) to a secure new folder (preferably: password-protected folder or push later to archive so the hacker has less chance of accessing it), and then delete it completely once it is determined it is a hack file and not needed for your Joomla site.


#### After the cleanup:

* although you have now (hopefully) identified and removed all hijacked files (remember: it may not be 100% accurate), this still shouldn't be the end of your work!

* to be to the point: you have now (temporarily) cured "the headache pain" only, but you have not cured "the source of your pains" - you have to identify how those files were compromised in the first place. A topic with further steps, which you should follow to get to the bottom of this issue and help properly clean and repair your website is here: viewtopic.php?f=621&t=582854

***

### You found malicious code that JAMSS didn't recognize?
There are so many malicious scripts out there, and every day new ones are coded and spread - it will take us much effort to get the JAMSS recognise most of them - so help us if you can, report and send (via PM or e-mail) the samples of malicious code that JAMSS misses to recognize. Thanks

***


#### Status
This is a "work in progress" so let me know if you have any problems, found bug, have questions or wish to help in some way.

***

#### Further reading - useful links
* http://forum.joomla.org/viewtopic.php?f=621&t=777957
* http://forum.joomla.org/viewtopic.php?f=621&t=777960
* http://forum.joomla.org
* http://forum.joomla.org/viewtopic.php?f=621&t=582854
* http://docs.joomla.org/Vulnerable_Extensions_List
* http://docs.joomla.org/Security_Checklist_7
